import numpy as np

energies = np.arange(1,100,2)

# sanity check for PMMA
reported_energies = np.array([\
    1.00E+00, 1.50E+00, 2.00E+00, 3.00E+00, 4.00E+00,\
    5.00E+00, 6.00E+00, 8.00E+00, 1.00E+01, 1.50E+01,\
    2.00E+01, 3.00E+01, 4.00E+01, 5.00E+01, 6.00E+01,\
    8.00E+01, 1.00E+02, 1.50E+02, 2.00E+02, 3.00E+02,\
    4.00E+02, 5.00E+02, 6.00E+02, 8.00E+02, 1.00E+03,\
    1.25E+03, 1.50E+03, 2.00E+03, 3.00E+03, 4.00E+03,\
    5.00E+03, 6.00E+03, 8.00E+03, 1.00E+04, 1.50E+04, 2.00E+04])

mu_per_density_PMMA = np.array([\
    2.794E+03, 9.153E+02, 4.037E+02, 1.236E+02, 5.247E+01,\
    2.681E+01, 1.545E+01, 6.494E+00, 3.357E+00, 1.101E+00,\
    5.714E-01, 3.032E-01, 2.350E-01, 2.074E-01, 1.924E-01,\
    1.751E-01, 1.641E-01, 1.456E-01, 1.328E-01, 1.152E-01,\
    1.031E-01, 9.410E-02, 8.701E-02, 7.641E-02, 6.870E-02,\
    6.143E-02, 5.591E-02, 4.796E-02, 3.844E-02, 3.286E-02,\
    2.919E-02, 2.659E-02, 2.317E-02, 2.105E-02, 1.820E-02, 1.684E-02])

result = np.exp(np.interp(energies, reported_energies, np.log(mu_per_density_PMMA), \
                            left = -np.inf, right = -np.inf))


def splitstr(input):
    l = input.split('\n')
    return np.array([float(number) for number in l])

def mu_generator(data):
    lines = data.strip().split("\n")
    energies = []
    mu_over_rho = []

    for line in lines:
        parts = line.split()
        energies.append(float(parts[0])*1e3)  # Energy
        mu_over_rho.append(float(parts[1]))    # μ/ρ

    # print("Energies:", energies)
    # print("μ/ρ Values:", mu_rho)

    # energies = splitstr(energy_str)
    # mu_over_rho = splitstr(mu_over_rho_str)
    result = np.exp(np.interp(np.arange(1,100,2), energies, np.log(mu_over_rho), \
                                left = -np.inf, right = -np.inf))
    return result

air_energy_str = '''1.000E+00
1.500E+00
2.000E+00
3.000E+00
3.203E+00
3.203E+00
4.000E+00
5.000E+00
6.000E+00
8.000E+00
1.000E+01
1.500E+01
2.000E+01
3.000E+01
4.000E+01
5.000E+01
6.000E+01
8.000E+01
1.000E+02
1.500E+02
2.000E+02
3.000E+02
4.000E+02
5.000E+02
6.000E+02
8.000E+02
1.000E+03
1.250E+03
1.500E+03
2.000E+03
3.000E+03
4.000E+03
5.000E+03
6.000E+03
8.000E+03
1.000E+04
1.500E+04
2.000E+04'''

air_mu_over_rho_str = '''3.606E+03
1.191E+03
5.279E+02
1.625E+02
1.340E+02
1.485E+02
7.788E+01
4.027E+01
2.341E+01
9.921E+00
5.120E+00
1.614E+00
7.779E-01
3.538E-01
2.485E-01
2.080E-01
1.875E-01
1.662E-01
1.541E-01
1.356E-01
1.233E-01
1.067E-01
9.549E-02
8.712E-02
8.055E-02
7.074E-02
6.358E-02
5.687E-02
5.175E-02
4.447E-02
3.581E-02
3.079E-02
2.751E-02
2.522E-02
2.225E-02
2.045E-02
1.810E-02
1.705E-02'''

air_energies = splitstr(air_energy_str)
air_mu_over_rho = splitstr(air_mu_over_rho_str)
air_result = np.exp(np.interp(energies, air_energies, np.log(air_mu_over_rho), \
                            left = -np.inf, right = -np.inf))

# print(air_result)

water_energy_str = '''1.00E+00
1.50E+00
2.00E+00
3.00E+00
4.00E+00
5.00E+00
6.00E+00
8.00E+00
1.00E+01
1.50E+01
2.00E+01
3.00E+01
4.00E+01
5.00E+01
6.00E+01
8.00E+01
1.00E+02
1.50E+02
2.00E+02
3.00E+02
4.00E+02
5.00E+02
6.00E+02
8.00E+02
1.00E+03
1.25E+03
1.50E+03
2.00E+03
3.00E+03
4.00E+03
5.00E+03
6.00E+03
8.00E+03
1.00E+04
1.50E+04
2.00E+04'''

water_mu_over_rho_str = '''4.078E+03
1.376E+03
6.173E+02
1.929E+02
8.278E+01
4.258E+01
2.464E+01
1.037E+01
5.329E+00
1.673E+00
8.096E-01
3.756E-01
2.683E-01
2.269E-01
2.059E-01
1.837E-01
1.707E-01
1.505E-01
1.370E-01
1.186E-01
1.061E-01
9.687E-02
8.956E-02
7.865E-02
7.072E-02
6.323E-02
5.754E-02
4.942E-02
3.969E-02
3.403E-02
3.031E-02
2.770E-02
2.429E-02
2.219E-02
1.941E-02
1.813E-02'''

water_energies = splitstr(water_energy_str)
water_mu_over_rho = splitstr(water_mu_over_rho_str)
water_result = np.exp(np.interp(energies, water_energies, np.log(water_mu_over_rho), \
                            left = -np.inf, right = -np.inf))

# print(water_result)


bone_data = '''1.00000E-03  3.781E+03  3.772E+03 
       1.03542E-03  3.452E+03  3.444E+03 
       1.07210E-03  3.150E+03  3.143E+03 
 1.07210E-03  3.156E+03  3.149E+03 
       1.18283E-03  2.434E+03  2.429E+03 
       1.30500E-03  1.873E+03  1.869E+03 
 1.30500E-03  1.883E+03  1.878E+03 
       1.50000E-03  1.295E+03  1.291E+03 
       2.00000E-03  5.869E+02  5.846E+02 
       2.14550E-03  4.824E+02  4.803E+02 
 2.14550E-03  7.114E+02  6.961E+02 
       2.30297E-03  5.916E+02  5.789E+02 
       2.47200E-03  4.907E+02  4.805E+02 
 2.47200E-03  4.962E+02  4.857E+02 
       3.00000E-03  2.958E+02  2.897E+02 
       4.00000E-03  1.331E+02  1.303E+02 
       4.03810E-03  1.296E+02  1.269E+02 
 4.03810E-03  3.332E+02  3.006E+02 
       5.00000E-03  1.917E+02  1.757E+02 
       6.00000E-03  1.171E+02  1.085E+02 
       8.00000E-03  5.323E+01  4.987E+01 
       1.00000E-02  2.851E+01  2.680E+01 
       1.50000E-02  9.032E+00  8.388E+00 
       2.00000E-02  4.001E+00  3.601E+00 
       3.00000E-02  1.331E+00  1.070E+00 
       4.00000E-02  6.655E-01  4.507E-01 
       5.00000E-02  4.242E-01  2.336E-01 
       6.00000E-02  3.148E-01  1.400E-01 
       8.00000E-02  2.229E-01  6.896E-02 
       1.00000E-01  1.855E-01  4.585E-02 
       1.50000E-01  1.480E-01  3.183E-02 
       2.00000E-01  1.309E-01  3.003E-02 
       3.00000E-01  1.113E-01  3.032E-02 
       4.00000E-01  9.908E-02  3.069E-02 
       5.00000E-01  9.022E-02  3.073E-02 
       6.00000E-01  8.332E-02  3.052E-02 
       8.00000E-01  7.308E-02  2.973E-02 
       1.00000E+00  6.566E-02  2.875E-02 
       1.25000E+00  5.871E-02  2.745E-02 
       1.50000E+00  5.346E-02  2.623E-02 
       2.00000E+00  4.607E-02  2.421E-02 
       3.00000E+00  3.745E-02  2.145E-02 
       4.00000E+00  3.257E-02  1.975E-02 
       5.00000E+00  2.946E-02  1.864E-02 
       6.00000E+00  2.734E-02  1.788E-02 
       8.00000E+00  2.467E-02  1.695E-02 
       1.00000E+01  2.314E-02  1.644E-02 
       1.50000E+01  2.132E-02  1.587E-02 
       2.00000E+01  2.068E-02  1.568E-02 '''

poly_data = '''1.00000E-03  1.894E+03  1.892E+03 
1.50000E-03  5.999E+02  5.988E+02 
2.00000E-03  2.593E+02  2.584E+02 
3.00000E-03  7.743E+01  7.678E+01 
4.00000E-03  3.242E+01  3.189E+01 
5.00000E-03  1.643E+01  1.598E+01 
6.00000E-03  9.432E+00  9.032E+00 
8.00000E-03  3.975E+00  3.635E+00 
1.00000E-02  2.088E+00  1.781E+00 
1.50000E-02  7.452E-01  4.834E-01 
2.00000E-02  4.315E-01  1.936E-01 
3.00000E-02  2.706E-01  5.932E-02 
4.00000E-02  2.275E-01  3.196E-02 
5.00000E-02  2.084E-01  2.442E-02 
6.00000E-02  1.970E-01  2.236E-02 
8.00000E-02  1.823E-01  2.265E-02 
1.00000E-01  1.719E-01  2.423E-02 
1.50000E-01  1.534E-01  2.789E-02 
2.00000E-01  1.402E-01  3.029E-02 
3.00000E-01  1.217E-01  3.276E-02 
4.00000E-01  1.089E-01  3.368E-02 
5.00000E-01  9.947E-02  3.390E-02 
6.00000E-01  9.198E-02  3.375E-02 
8.00000E-01  8.078E-02  3.295E-02 
1.00000E+00  7.262E-02  3.190E-02 
1.25000E+00  6.495E-02  3.049E-02 
1.50000E+00  5.910E-02  2.914E-02 
2.00000E+00  5.064E-02  2.677E-02 
3.00000E+00  4.045E-02  2.328E-02 
4.00000E+00  3.444E-02  2.091E-02 
5.00000E+00  3.045E-02  1.921E-02 
6.00000E+00  2.760E-02  1.794E-02 
8.00000E+00  2.383E-02  1.620E-02 
1.00000E+01  2.145E-02  1.506E-02 
1.50000E+01  1.819E-02  1.344E-02 
2.00000E+01  1.658E-02  1.260E-02'''

acrylic_data = '''1.00000E-03  2.794E+03  2.788E+03 
1.50000E-03  9.153E+02  9.131E+02 
2.00000E-03  4.037E+02  4.024E+02 
3.00000E-03  1.236E+02  1.228E+02 
4.00000E-03  5.247E+01  5.181E+01 
5.00000E-03  2.681E+01  2.627E+01 
6.00000E-03  1.545E+01  1.498E+01 
8.00000E-03  6.494E+00  6.114E+00 
1.00000E-02  3.357E+00  3.026E+00 
1.50000E-02  1.101E+00  8.324E-01 
2.00000E-02  5.714E-01  3.328E-01 
3.00000E-02  3.032E-01  9.645E-02 
4.00000E-02  2.350E-01  4.599E-02 
5.00000E-02  2.074E-01  3.067E-02 
6.00000E-02  1.924E-01  2.530E-02 
8.00000E-02  1.751E-01  2.302E-02 
1.00000E-01  1.641E-01  2.368E-02 
1.50000E-01  1.456E-01  2.657E-02 
2.00000E-01  1.328E-01  2.872E-02 
3.00000E-01  1.152E-01  3.099E-02 
4.00000E-01  1.031E-01  3.185E-02 
5.00000E-01  9.410E-02  3.206E-02 
6.00000E-01  8.701E-02  3.191E-02 
8.00000E-01  7.641E-02  3.116E-02 
1.00000E+00  6.870E-02  3.015E-02 
1.25000E+00  6.143E-02  2.882E-02 
1.50000E+00  5.591E-02  2.755E-02 
2.00000E+00  4.796E-02  2.533E-02 
3.00000E+00  3.844E-02  2.210E-02 
4.00000E+00  3.286E-02  1.995E-02 
5.00000E+00  2.919E-02  1.843E-02 
6.00000E+00  2.659E-02  1.731E-02 
8.00000E+00  2.317E-02  1.579E-02 
1.00000E+01  2.105E-02  1.482E-02 
1.50000E+01  1.820E-02  1.348E-02 
2.00000E+01  1.684E-02  1.282E-02'''


cesium_iodine_data = '''
1.00000E-03  9.234E+03  9.213E+03 
       1.03199E-03  8.653E+03  8.633E+03 
       1.06500E-03  8.098E+03  8.080E+03 
       1.06500E-03  8.339E+03  8.320E+03 
       1.06854E-03  8.281E+03  8.262E+03 
       1.07210E-03  8.224E+03  8.205E+03 
       1.07210E-03  8.387E+03  8.368E+03 
       1.14230E-03  7.344E+03  7.327E+03 
       1.21710E-03  6.413E+03  6.398E+03 
       1.21710E-03  6.569E+03  6.553E+03 
       1.50000E-03  4.132E+03  4.120E+03 
       2.00000E-03  2.114E+03  2.104E+03 
       3.00000E-03  7.880E+02  7.809E+02 
       4.00000E-03  3.836E+02  3.776E+02 
       4.55710E-03  2.752E+02  2.696E+02 
       4.55710E-03  5.174E+02  4.936E+02 
       4.70229E-03  4.851E+02  4.628E+02 
       4.85210E-03  4.510E+02  4.303E+02 
       4.85210E-03  5.637E+02  5.332E+02 
       5.00000E-03  5.296E+02  5.012E+02 
       5.01190E-03  5.268E+02  4.985E+02 
       5.01190E-03  7.511E+02  7.037E+02 
       5.09924E-03  7.193E+02  6.744E+02 
       5.18810E-03  6.881E+02  6.457E+02 
       5.18810E-03  7.453E+02  6.987E+02 
       5.27305E-03  7.196E+02  6.716E+02 
       5.35940E-03  6.875E+02  6.454E+02 
       5.35940E-03  7.923E+02  7.397E+02 
       5.53401E-03  7.323E+02  6.847E+02 
       5.71430E-03  6.761E+02  6.331E+02 
       5.71430E-03  7.268E+02  6.795E+02 
       6.00000E-03  6.448E+02  6.043E+02 
       8.00000E-03  3.071E+02  2.906E+02 
       1.00000E-02  1.711E+02  1.624E+02 
       1.50000E-02  5.815E+01  5.486E+01 
       2.00000E-02  2.686E+01  2.496E+01 
       3.00000E-02  9.045E+00  8.071E+00 
       3.31694E-02  6.923E+00  6.088E+00 
       3.31694E-02  2.122E+01  9.086E+00 
       3.45483E-02  2.687E+01  8.529E+00 
       3.59846E-02  1.719E+01  7.990E+00 
       3.59846E-02  3.027E+01  1.059E+01 
       4.00000E-02  2.297E+01  9.395E+00 
       5.00000E-02  1.287E+01  6.596E+00 
       6.00000E-02  7.921E+00  4.586E+00 
       8.00000E-02  3.677E+00  2.399E+00 
       1.00000E-01  2.035E+00  1.391E+00 
       1.50000E-01  7.290E-01  4.951E-01 
       2.00000E-01  3.805E-01  2.401E-01 
       3.00000E-01  1.818E-01  9.634E-02 
       4.00000E-01  1.237E-01  5.828E-02 
       5.00000E-01  9.809E-02  4.366E-02 
       6.00000E-01  8.373E-02  3.657E-02 
       8.00000E-01  6.769E-02  2.987E-02 
       1.00000E+00  5.848E-02  2.657E-02 
       1.25000E+00  5.110E-02  2.402E-02 
       1.50000E+00  4.644E-02  2.243E-02 
       2.00000E+00  4.123E-02  2.089E-02 
       3.00000E+00  3.721E-02  2.059E-02 
       4.00000E+00  3.616E-02  2.144E-02 
       5.00000E+00  3.622E-02  2.255E-02 
       6.00000E+00  3.673E-02  2.364E-02 
       8.00000E+00  3.838E-02  2.563E-02 
       1.00000E+01  4.030E-02  2.725E-02 
       1.50000E+01  4.492E-02  2.992E-02 
       2.00000E+01  4.867E-02  3.114E-02 
'''

iodine_data = '''
1.00000E-03  9.096E+03  9.078E+03 
   1.03542E-03  8.465E+03  8.448E+03 
   1.07210E-03  7.863E+03  7.847E+03 
 1.07210E-03  8.198E+03  8.181E+03 
   1.50000E-03  3.919E+03  3.908E+03 
   2.00000E-03  1.997E+03  1.988E+03 
   3.00000E-03  7.420E+02  7.351E+02 
   4.00000E-03  3.607E+02  3.548E+02 
   4.55710E-03  2.592E+02  2.537E+02 
 4.55710E-03  7.550E+02  7.121E+02 
   4.70229E-03  7.123E+02  6.724E+02 
   4.85210E-03  6.636E+02  6.270E+02 
 4.85210E-03  8.943E+02  8.375E+02 
   5.00000E-03  8.430E+02  7.903E+02 
   5.18810E-03  7.665E+02  7.198E+02 
 5.18810E-03  8.837E+02  8.283E+02 
   6.00000E-03  6.173E+02  5.822E+02 
   8.00000E-03  2.922E+02  2.777E+02 
   1.00000E-02  1.626E+02  1.548E+02 
   1.50000E-02  5.512E+01  5.208E+01 
   2.00000E-02  2.543E+01  2.363E+01 
   3.00000E-02  8.561E+00  7.622E+00 
   3.31694E-02  6.553E+00  5.744E+00 
  3.31694E-02  3.582E+01  1.188E+01 
   4.00000E-02  2.210E+01  9.616E+00 
   5.00000E-02  1.232E+01  6.573E+00 
   6.00000E-02  7.579E+00  4.518E+00 
   8.00000E-02  3.510E+00  2.331E+00 
   1.00000E-01  1.942E+00  1.342E+00 
   1.50000E-01  6.978E-01  4.742E-01 
   2.00000E-01  3.663E-01  2.295E-01 
   3.00000E-01  1.771E-01  9.257E-02 
   4.00000E-01  1.217E-01  5.650E-02 
   5.00000E-01  9.701E-02  4.267E-02 
   6.00000E-01  8.313E-02  3.598E-02 
   8.00000E-01  6.749E-02  2.962E-02 
   1.00000E+00  5.841E-02  2.646E-02 
   1.25000E+00  5.111E-02  2.399E-02 
   1.50000E+00  4.647E-02  2.243E-02 
   2.00000E+00  4.124E-02  2.092E-02 
   3.00000E+00  3.716E-02  2.059E-02 
   4.00000E+00  3.607E-02  2.142E-02 
   5.00000E+00  3.608E-02  2.250E-02 
   6.00000E+00  3.655E-02  2.357E-02 
   8.00000E+00  3.815E-02  2.553E-02 
   1.00000E+01  4.002E-02  2.714E-02 
   1.50000E+01  4.455E-02  2.980E-02 
   2.00000E+01  4.823E-02  3.101E-02  
'''